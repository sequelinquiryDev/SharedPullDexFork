1/ our ONCHAIN price and data fetching using multiple sources and smart algos but it is a place holder for some logics now , fill them and intergrate real algos professional scalable.

2/ every code you make should deal with token by address and chain id because we are multi chain app, and every thing you create must be cloudflare compatible,  this app will be deployed in cloudflare so must match

3/WE WILL Create new server side dynamic watchlist, the list add a new token if any of clints selected" the new token at any of (from/to) inputs. And this dynamic watchlist it remove a token if no SUBSCRIBERS to the token for 1h and 5 min, then the token gets deleated from the dynamic watchlist 
This new dynamic watchlist which detects all subscrbers selected tokens ,and UNSUBSCRIBED tokens for more than 1h 5min.  Dynamic file deals by singleflight collecting clints selected token and subscribers, for better scalability 

When clint subscripe he should immediately received cached , if no cache then server do the onchain fetching and cache it again and user Imeadietly get it from cached auto after been recieved
 Now according to the ONCHAIN data
 tfetch,and make very precise calculations with 100% probability data is accurate for these ONCHAIN data only (volume, 24h%move, marketcap) REFRESHED HOURLY "fixed by GMT/utc global timing, and refresh new added tokens immediately and then sync it to the others hourly refresh . at the end of every hour it refreshes the whole new watchlist onchain data , cache it for 1h and 5 minutes server side and caching deleted if new update data cached even if beforethe 1h5min ttl, so new next subscribers get initial fetching directly from server caching first , if not there then it means a new token to the dynamic watchlist , so the server 8sec window singleflight to bring the new tokens added,  fetch it is ONCHAIN data. With professional handling when multiple or SOUTHANDS tokens been added at close time to each, the server professionally execute single flight detecting every 8 sec to see if new tokens been added to the new watchlist,  so the server immediately, execute directly ONCHAIN data fetching for only the new token added to our watchlist during this 8 sec single flight detecting ,  then after initial data fetching and caching the token data and refreshing will be synced normally like other tokend in list with the global hourly timing refresh and caching so subscriber and next hours subscribers will get the same recent cached data Imeadietly when cached , by single flight refreshto clints SUBSCRIBED...  always clints when select a token they immediately get SUBSCRIBED to get every hour ONCHAIN data of the clint selected token/tokens (volume, 24h%move and market cap), once he select a token he considered subscriber even if he changed the selected tokens after that again , he will be subscriber to all selected tokens in the same session, The clint get UNSUBSCRIBED when become offline or at the end of the session. newly SUBSCRIBED clints gets initial the server cached data, if not there then the server will already detected a new token in watchlist, so he will fetch the data and cache it to be refreshed and cached again to waite to the next  global timing refreshs at the end of every hour , then SUBSCRIBED CLINTS RECEIVES data about all tokens they SUBSCRIBED, with out sending hourly refresh requests to server , the server deal with tokens individually and when a new hourly data fetched it is automatically cached and singleflight to meant subscribers 
Every thing should be scalable,  to 100k users at the same moment, make sure you use all ideas to reduce heavy traffic and requsts , by making everything will run smoothly and very scalable
Make sure our new dynamic watchlist for ONCHAIN it can remove tokens who has no subscripers activate for 1h5min , SO WHEN A TOKEN GETS 0 SUBSCRIBERS THEN THE DYNAMIC WATCHLIST ACTIVATE 1H5MIN TTL BEFORE REMOVE IT , IF ANY SUBSCRIBERS SHOWS BEFORE THE END OF THE TIME THEN THE TIMER STOPS, RESETS AND WAIT FOR 0 SUBSCRIBERS AGAIN TO START 1H5MIN TIMER AGAIN



 

